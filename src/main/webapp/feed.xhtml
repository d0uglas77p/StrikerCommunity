<!DOCTYPE html>
<html xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns="http://www.w3.org/1999/xhtml">

<h:head>
    <title>Striker Community</title>
    <h:outputStylesheet name="css/feed.css"/>
</h:head>

<body>
<div>
    <h:form>
        <!-- MENU DE NAVEGAÇÃO -->
        <p:panelGrid columns="2">
            <h:panelGrid style="margin-left: 60px;">
                <p:graphicImage name="images/logo.png" width="340" height="60"/>
            </h:panelGrid>

            <h:panelGrid style="margin-left: -70px;">
                <p:menubar orientation="horizontal" autoDisplay="false">
                    <p:menuitem value="Início"
                                action="#{navegacaoBean.irInicio}"/>

                    <p:submenu label="Comunidade">
                        <p:menuitem value="Feed" action="#{navegacaoBean.irFeed}"/>
                        <p:menuitem value="Fórum" action="#{navegacaoBean.irForum}"/>
                    </p:submenu>

                    <p:submenu label="Counter Strike 2">
                        <p:menuitem value="Utilitários" action="#{navegacaoBean.irUtilitario}"/>
                        <p:menuitem value="Comandos" action="#{navegacaoBean.irComandos}"/>
                    </p:submenu>

                    <p:menuitem value="Meu Perfil"
                                action="#{navegacaoBean.irMeuPerfil}"/>

                </p:menubar>

                <p:panelGrid style="margin-left: 460px; margin-top: -61px;">
                    <p:commandButton value="Sair" icon="pi pi-fw pi-sign-out" styleClass="ui-button-info"
                                     action="#{navegacaoBean.irLogin}"/>
                </p:panelGrid>
            </h:panelGrid>
        </p:panelGrid>
        <!-- MENU DE NAVEGAÇÃO -->
    </h:form>

    <h:form id="feedForm">
        <div class="fixed-buttons">
            <h:panelGroup columns="2">
                <p:commandButton id="tooltipPublicarButton"
                                 value="Publicar"
                                 styleClass="rounded-button"
                                 style="right: 10px;"
                                 oncomplete="PF('publicacaoDialog').show()"/>
                <p:tooltip for="tooltipPublicarButton"
                           value="Publicar conteúdo"
                           showEffect="clip"
                           hideEffect="fold"
                           my="right center"
                           at="left center"/>

                <p:commandButton id="tooltipFeedButton"
                                 icon="pi pi-refresh"
                                 styleClass="rounded-button"
                                 style="left: 10px;"
                                 action="#{feedBean.atualizarFeed}"
                                 update=":feedForm:postagensContainer :feedForm:messages"/>
                <p:tooltip for="tooltipFeedButton"
                           value="Atualizar o feed de postagens"
                           showEffect="clip"
                           hideEffect="fold"/>
            </h:panelGroup>
        </div>

        <div>
            <p:dialog header="Publicação"
                      widgetVar="publicacaoDialog"
                      modal="true"
                      resizable="false"
                      width="1040"
                      height="307">

                <p:growl id="messages" showDetail="true"/>

                <p:outputPanel header="Publicação" class="panel-publicacao">
                    <p:textEditor id="mensagem"
                                  value="#{feedBean.mensagem}"
                                  widgetVar="editorWidget"
                                  width="600"
                                  styleClass="editor"/>

                    <br></br>
                    <br></br>
                    <br></br>

                    <h:panelGrid columns="2">
                        <p:outputLabel style="margin-left: 317px;"
                                       styleClass="placeholder-text"
                                       value="Interaja com a comunidade, retire suas dúvidas, compartilhe os seus Highlights..."/>

                        <p:commandButton value="Publicar"
                                         style="left: 35px; top: -5px;"
                                         action="#{feedBean.publicar}"
                                         update=":feedForm:postagensContainer :feedForm:mensagem :feedForm:messages"
                                         oncomplete="PF('publicacaoDialog').hide()"/>

                    </h:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </div>

        <br></br>
        <br></br>

        <h:panelGroup id="postagensContainer">
            <p:dataScroller widgetVar="ds"
                            value="#{feedBean.postagens}"
                            var="postagem"
                            chunkSize="10"
                            styleClass="postagem-dataScroller">

                <f:facet name="loading">
                    <div>
                        <p:skeleton height="100px" width="100%" style="margin-bottom: 10px;"/>
                    </div>
                </f:facet>

                <p:panel id="postagemPanel"
                         style="margin-top: 10px;"
                         class="postagem-panel">

                    <p:panelGrid columns="2" styleClass="postagem-grid">
                        <h:outputText value="#{feedBean.formatarDataPublicacao()}"
                                      styleClass="placeholder-text"
                                      style="margin-left: -50px;"/>

                        <p:avatar styleClass="mr-2"
                                  size="medium"
                                  shape="circle"
                                  style="margin-top: -8px;">
                            <p:graphicImage name="images/avatar.png"/>
                        </p:avatar>
                    </p:panelGrid>

                    <h:outputText value="#{postagem}"
                                  escape="false"
                                  styleClass="postagem-content"/>
                </p:panel>

                <br></br>

                <f:facet name="loader">
                    <div>
                        <p:commandButton type="button"
                                         value="Ver Mais"
                                         icon="pi pi-refresh"
                                         style="left: 450px;"
                                         styleClass="scroller-button"
                                         onclick="PF('ds').loadChunk()"/>
                    </div>
                </f:facet>
            </p:dataScroller>
        </h:panelGroup>
        <br></br>
        <br></br>
        <br></br>
    </h:form>
</div>
</body>

</html>
